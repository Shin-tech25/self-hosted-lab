const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=[window.OC.filePath('whiteboard', '', 'js/App-DebfuW2G.chunk.mjs'),window.OC.filePath('whiteboard', '', 'js/vendor-DscDELSF.chunk.mjs'),window.OC.filePath('whiteboard', '', 'js/NcLoadingIcon-DT2u8-xt.chunk.mjs'),window.OC.filePath('whiteboard', '', 'js/index-BZGs7a1j.chunk.mjs'),window.OC.filePath('whiteboard', '', 'css/NcLoadingIcon-CU79x4Rz.chunk.css'),window.OC.filePath('whiteboard', '', 'css/App-CL3cMgzR.chunk.css')])))=>i.map(i=>d[i]);
/*! third party licenses: js/vendor.LICENSE.txt */
import{r as f,a as k,R as m}from"./vendor-DscDELSF.chunk.mjs";import{l as h,R as L}from"./index-BZGs7a1j.chunk.mjs";const P="modulepreload",T=function(e,n){return new URL(e,n).href},b={},A=function(e,n,t){let d=Promise.resolve();if(n&&n.length>0){const r=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),p=o?.nonce||o?.getAttribute("nonce");d=Promise.allSettled(n.map(i=>{if(i=T(i,t),i in b)return;b[i]=!0;const s=i.endsWith(".css"),_=s?'[rel="stylesheet"]':"";if(t)for(let a=r.length-1;a>=0;a--){const u=r[a];if(u.href===i&&(!s||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${_}`))return;const l=document.createElement("link");if(l.rel=s?"stylesheet":P,s||(l.as="script"),l.crossOrigin="",l.href=i,p&&l.setAttribute("nonce",p),document.head.appendChild(l),s)return new Promise((a,u)=>{l.addEventListener("load",a),l.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${i}`)))})}))}function c(r){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=r,window.dispatchEvent(o),!o.defaultPrevented)throw r}return d.then(r=>{for(const o of r||[])o.status==="rejected"&&c(o.reason);return e().catch(c)})};function w(){return h("files_sharing","isPublic",null)??document.querySelector('input#isPublic[type="hidden"][name="isPublic"][value="1"]')!==null}function E(){return h("files_sharing","sharingToken",null)??document.querySelector('input#sharingToken[type="hidden"]')?.value??null}const C=L("whiteboard","dist/"),$=f.lazy(()=>A(()=>import("./App-DebfuW2G.chunk.mjs"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)),g=()=>Math.random().toString(36).replace(/[^a-z]+/g,"").substr(2,10),y=(e,n)=>{const t=k.createRoot(e);return t.render(m.createElement(f.StrictMode,null,m.createElement(f.Suspense,{fallback:m.createElement("div",null,"Loading...")},m.createElement($,{...n})))),t};window.EXCALIDRAW_ASSET_PATH=C;const I=E();w()&&R(I),q();function R(e){if(document.querySelector(".files-list__table")||document.querySelector("#preview table.files-filestable")){const t=v();S(t);return}const n=h("whiteboard","file_id");document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("preview");if(!t){console.error("#imgframe element not found");return}const d=document.getElementById("mimetype"),c=d&&d.value==="application/vnd.excalidraw+json";if(w()&&!c)return;t.innerHTML="";const r=B();t.appendChild(r),y(r,{fileId:n,isEmbedded:!1,fileName:document.title,publicSharingToken:e})})}function q(){const e=v();typeof OCA.Viewer<"u"?S(e):console.error("Could not register whiteboard handler for viewer")}function B(){const e=document.createElement("div");return e.id=`whiteboard-${g()}`,e.className="whiteboard",e}function v(){return{name:"Whiteboard",render(e){this.$emit("update:loaded",!0);const n=g();return this.$nextTick(()=>{const t=document.getElementById(`whiteboard-${n}`);t.addEventListener("keydown",d=>{d.key==="Escape"&&d.stopPropagation()}),this.root=y(t,{fileId:this.fileid,isEmbedded:this.isEmbedded,fileName:this.basename,publicSharingToken:E()})}),e("div",{attrs:{id:`whiteboard-${n}`},class:["whiteboard",{"whiteboard-viewer__embedding":this.isEmbedded}]},"")},beforeDestroy(){this.root?.unmount()},props:{filename:{type:String,default:null},fileid:{type:Number,default:null},isEmbedded:{type:Boolean,default:!1}},data:()=>({root:null})}}function S(e){window.OCA.Viewer.registerHandler({id:"whiteboard",mimes:["application/vnd.excalidraw+json"],component:e,group:null,theme:"default",canCompare:!0})}export{E as g};
