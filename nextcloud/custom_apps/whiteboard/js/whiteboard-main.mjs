const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=[window.OC.filePath('whiteboard', '', 'js/App-yJVN-JBN.chunk.mjs'),window.OC.filePath('whiteboard', '', 'js/NcLoadingIcon-Bg5K4W6G.chunk.mjs'),window.OC.filePath('whiteboard', '', 'js/vendor-BeFBwUwf.chunk.mjs'),window.OC.filePath('whiteboard', '', 'js/index-BZGs7a1j.chunk.mjs'),window.OC.filePath('whiteboard', '', 'css/NcLoadingIcon-CqU_RxXY.chunk.css'),window.OC.filePath('whiteboard', '', 'css/App-Dtowuwj9.chunk.css')])))=>i.map(i=>d[i]);
/*! third party licenses: js/vendor.LICENSE.txt */
import{r as P,g as L,a as T}from"./vendor-BeFBwUwf.chunk.mjs";import{l as m,R as A}from"./index-BZGs7a1j.chunk.mjs";const B="modulepreload",C=function(e,n){return new URL(e,n).href},E={},$=function(e,n,t){let a=Promise.resolve();if(n&&n.length>0){let i=function(o){return Promise.all(o.map(s=>Promise.resolve(s).then(c=>({status:"fulfilled",value:c}),c=>({status:"rejected",reason:c}))))};const r=document.getElementsByTagName("link"),b=document.querySelector("meta[property=csp-nonce]"),w=b?.nonce||b?.getAttribute("nonce");a=i(n.map(o=>{if(o=C(o,t),o in E)return;E[o]=!0;const s=o.endsWith(".css"),c=s?'[rel="stylesheet"]':"";if(t)for(let u=r.length-1;u>=0;u--){const f=r[u];if(f.href===o&&(!s||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${c}`))return;const l=document.createElement("link");if(l.rel=s?"stylesheet":B,s||(l.as="script"),l.crossOrigin="",l.href=o,w&&l.setAttribute("nonce",w),document.head.appendChild(l),s)return new Promise((u,f)=>{l.addEventListener("load",u),l.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})}))}function d(i){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=i,window.dispatchEvent(r),!r.defaultPrevented)throw i}return a.then(i=>{for(const r of i||[])r.status==="rejected"&&d(r.reason);return e().catch(d)})};var p=P();const h=L(p);var I=T();function g(){return m("files_sharing","isPublic",null)??document.querySelector('input#isPublic[type="hidden"][name="isPublic"][value="1"]')!==null}function v(){return m("files_sharing","sharingToken",null)??document.querySelector('input#sharingToken[type="hidden"]')?.value??null}const q=A("whiteboard","dist/"),R=p.lazy(()=>$(()=>import("./App-yJVN-JBN.chunk.mjs"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)),y=()=>Math.random().toString(36).replace(/[^a-z]+/g,"").substr(2,10),S=(e,n)=>{const t=I.createRoot(e);return t.render(h.createElement(p.StrictMode,null,h.createElement(p.Suspense,{fallback:h.createElement("div",null,"Loading...")},h.createElement(R,{...n})))),t};window.EXCALIDRAW_ASSET_PATH=q;const U=v();g()&&N(U),O();function N(e){if(document.querySelector(".files-list__table")||document.querySelector("#preview table.files-filestable")){const t=k();_(t);return}const n=m("whiteboard","file_id");document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("preview");if(!t){console.error("#imgframe element not found");return}const a=document.getElementById("mimetype"),d=a&&a.value==="application/vnd.excalidraw+json";if(g()&&!d)return;t.innerHTML="";const i=x();t.appendChild(i);const r=m("whiteboard","collabBackendUrl","");S(i,{fileId:n,isEmbedded:!1,fileName:document.title,publicSharingToken:e,collabBackendUrl:r})})}function O(){const e=k();typeof OCA.Viewer<"u"?_(e):console.error("Could not register whiteboard handler for viewer")}function x(){const e=document.createElement("div");return e.id=`whiteboard-${y()}`,e.className="whiteboard",e}function k(){return{name:"Whiteboard",render(e){this.$emit("update:loaded",!0);const n=y();return this.$nextTick(()=>{const t=document.getElementById(`whiteboard-${n}`);t.addEventListener("keydown",d=>{d.key==="Escape"&&d.stopPropagation()});const a=m("whiteboard","collabBackendUrl","");this.root=S(t,{fileId:this.fileid,isEmbedded:this.isEmbedded,fileName:this.basename,publicSharingToken:v(),collabBackendUrl:a})}),e("div",{attrs:{id:`whiteboard-${n}`},class:["whiteboard",{"whiteboard-viewer__embedding":this.isEmbedded}]},"")},beforeDestroy(){this.root?.unmount()},props:{filename:{type:String,default:null},fileid:{type:Number,default:null},isEmbedded:{type:Boolean,default:!1}},data:()=>({root:null})}}function _(e){window.OCA.Viewer.registerHandler({id:"whiteboard",mimes:["application/vnd.excalidraw+json"],component:e,group:null,theme:"default",canCompare:!0})}export{h as R,I as a,v as g,p as r};
//# sourceMappingURL=whiteboard-main.mjs.map
