"use strict";(self.webpackChunktables=self.webpackChunktables||[]).push([["src_modules_modals_FileActionImport_vue-data_image_svg_xml_3c_21--_20-_20SPDX-FileCopyrightTe-e9dd95","data_image_svg_xml_3c_21--_20-_20SPDX-FileCopyrightText_202020_20Google_20Inc_20-_20SPDX-Lice-cc29b1"],{98531:(t,e,s)=>{s.d(e,{A:()=>i});var a=s(71354),n=s.n(a),l=s(76314),o=s.n(l)()(n());o.push([t.id,".modal__content[data-v-773d887d]{margin:20px}.row[data-v-773d887d]{margin:20px 0}.switch[data-v-773d887d]{margin:5px}.end[data-v-773d887d]{display:flex;flex-flow:row nowrap;justify-content:flex-end}","",{version:3,sources:["webpack://./src/modules/modals/FileActionImport.vue"],names:[],mappings:"AACA,iCACC,WAAA,CAGD,sBACC,aAAA,CAGD,yBACC,UAAA,CAGD,sBACC,YAAA,CACA,oBAAA,CACA,wBAAA",sourceRoot:""}]);const i=o},72062:(t,e,s)=>{s.d(e,{A:()=>i});var a=s(71354),n=s.n(a),l=s(76314),o=s.n(l)()(n());o.push([t.id,".title[data-v-7a407e98]{font-weight:bold;margin-bottom:calc(var(--default-grid-baseline)*1)}.slot[data-v-7a407e98]{align-items:baseline}.material-design-icon.loading-icon[data-v-7a407e98]{margin-left:calc(var(--default-grid-baseline)*1)}pre[data-v-7a407e98]{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}","",{version:3,sources:["webpack://./src/shared/components/ncTable/partials/rowTypePartials/RowFormWrapper.vue"],names:[],mappings:"AAEA,wBACC,gBAAA,CACA,kDAAA,CAGD,uBACC,oBAAA,CAGD,oDACC,gDAAA,CAGD,qBACC,oBAAA,CACA,yBAAA,CACA,qBAAA,CACA,uBAAA,CACA,oBAAA",sourceRoot:""}]);const i=o},11231:(t,e,s)=>{s.d(e,{A:()=>i});var a=s(71354),n=s.n(a),l=s(76314),o=s.n(l)()(n());o.push([t.id,"\n.file_import__results[data-v-1f266310] {\n\tmargin: auto;\n\tmin-width: 350px;\n\tmax-width: 600px;\n& caption[data-v-1f266310] {\n\t\tfont-weight: bold;\n\t\tmargin: calc(var(--default-grid-baseline) * 2) auto;\n}\n}\n","",{version:3,sources:["webpack://./src/modules/modals/ImportResults.vue"],names:[],mappings:";AAqFA;CACA,YAAA;CACA,gBAAA;CACA,gBAAA;AAEA;EACA,iBAAA;EACA,mDAAA;AACA;AACA",sourcesContent:["\x3c!--\n  - SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n--\x3e\n<template>\n\t<table class=\"file_import__results\">\n\t\t<caption>\n\t\t\t{{ t('tables', 'Result') }}\n\t\t</caption>\n\n\t\t<tbody>\n\t\t\t<tr>\n\t\t\t\t<td>{{ t('tables', 'Found columns') }}</td>\n\t\t\t\t<td data-cy=\"importResultColumnsFound\">\n\t\t\t\t\t{{ results.found_columns_count }}\n\t\t\t\t</td>\n\t\t\t</tr>\n\n\t\t\t<tr>\n\t\t\t\t<td>{{ t('tables', 'Matching columns') }}</td>\n\t\t\t\t<td data-cy=\"importResultColumnsMatch\">\n\t\t\t\t\t{{ results.matching_columns_count }}\n\t\t\t\t</td>\n\t\t\t</tr>\n\n\t\t\t<tr>\n\t\t\t\t<td>{{ t('tables', 'Created columns') }}</td>\n\t\t\t\t<td data-cy=\"importResultColumnsCreated\">\n\t\t\t\t\t{{ results.created_columns_count }}\n\t\t\t\t</td>\n\t\t\t</tr>\n\n\t\t\t<tr>\n\t\t\t\t<td>{{ t('tables', 'Inserted rows') }}</td>\n\t\t\t\t<td data-cy=\"importResultRowsInserted\">\n\t\t\t\t\t{{ results.inserted_rows_count }}\n\t\t\t\t</td>\n\t\t\t</tr>\n\n\t\t\t<tr>\n\t\t\t\t<td>{{ t('tables', 'Value parsing errors') }}</td>\n\t\t\t\t<td data-cy=\"importResultParsingErrors\">\n\t\t\t\t\t{{ results.errors_parsing_count }}\n\t\t\t\t</td>\n\t\t\t</tr>\n\n\t\t\t<tr>\n\t\t\t\t<td>{{ t('tables', 'Row creation errors') }}</td>\n\t\t\t\t<td data-cy=\"importResultRowErrors\">\n\t\t\t\t\t{{ results.errors_count }}\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</tbody>\n\t</table>\n</template>\n\n<script>\nimport { translate as t } from '@nextcloud/l10n'\n\nexport default {\n\tname: 'ImportResults',\n\n\tprops: {\n\t\tresults: {\n\t\t\ttype: Object,\n\t\t\tdefault() {\n\t\t\t\treturn {\n\t\t\t\t\tfound_columns_count: 0,\n\t\t\t\t\tmatching_columns_count: 0,\n\t\t\t\t\tcreated_columns_count: 0,\n\t\t\t\t\tinserted_rows_count: 0,\n\t\t\t\t\terrors_parsing_count: 0,\n\t\t\t\t\terrors_count: 0,\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t},\n\n\tmethods: {\n\t\tt,\n\t},\n}\n<\/script>\n\n<style scoped>\n.file_import__results {\n\tmargin: auto;\n\tmin-width: 350px;\n\tmax-width: 600px;\n\n\t& caption {\n\t\tfont-weight: bold;\n\t\tmargin: calc(var(--default-grid-baseline) * 2) auto;\n\t}\n}\n</style>\n"],sourceRoot:""}]);const i=o},40387:(t,e,s)=>{s.d(e,{default:()=>P});var a=s(76333),n=s(63814),l=s(11636),o=s(85168),i=s(70715),r=s(53334);const c={components:{NcLoadingIcon:a.ne},props:{mandatory:{type:Boolean,default:!1},title:{type:String,default:""},length:{type:Number,default:null},maxLength:{type:Number,default:null},description:{type:String,default:null},width:{type:Number,default:4},loading:{type:Boolean,default:!1}},computed:{hasHeadSlot(){return!!this.$slots.head?.[0]}},methods:{t:r.Tl}};var d=s(85072),u=s.n(d),p=s(97825),m=s.n(p),A=s(77659),_=s.n(A),g=s(55056),b=s.n(g),h=s(10540),w=s.n(h),f=s(41113),v=s.n(f),C=s(72062),y={};y.styleTagTransform=v(),y.setAttributes=b(),y.insert=_().bind(null,"head"),y.domAPI=m(),y.insertStyleElement=w();u()(C.A,y);C.A&&C.A.locals&&C.A.locals;var x=s(14486);const T=(0,x.A)(c,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"row space-T"},[e("div",{class:{"fix-col-3":t.hasHeadSlot,"fix-col-4":!t.hasHeadSlot}},[e("div",{staticClass:"row"},[e("div",{staticClass:"title fix-col-4"},[t._v("\n\t\t\t\t"+t._s(t.title)),t.mandatory?e("span",{attrs:{title:t.t("tables","This field is mandatory")}},[t._v("*")]):t._e(),t._v(" "),t.loading?e("NcLoadingIcon"):t._e()],1),t._v(" "),t.description?e("p",{staticClass:"fix-col-4 span"},[e("pre",[t._v(t._s(t.description))])]):t._e()])]),t._v(" "),t.hasHeadSlot?e("div",{staticClass:"fix-col-1 end"},[t._t("head")],2):t._e(),t._v(" "),e("div",{staticClass:"slot",class:[`fix-col-${t.width}`]},[t._t("default")],2)])}),[],!1,null,"7a407e98",null).exports;const R={name:"ImportResults",props:{results:{type:Object,default:()=>({found_columns_count:0,matching_columns_count:0,created_columns_count:0,inserted_rows_count:0,errors_parsing_count:0,errors_count:0})}},methods:{t:r.Tl}};var I=s(11231),S={};S.styleTagTransform=v(),S.setAttributes=b(),S.insert=_().bind(null,"head"),S.domAPI=m(),S.insertStyleElement=w();u()(I.A,S);I.A&&I.A.locals&&I.A.locals;const D=(0,x.A)(R,(function(){var t=this,e=t._self._c;return e("table",{staticClass:"file_import__results"},[e("caption",[t._v("\n\t\t"+t._s(t.t("tables","Result"))+"\n\t")]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v(t._s(t.t("tables","Found columns")))]),t._v(" "),e("td",{attrs:{"data-cy":"importResultColumnsFound"}},[t._v("\n\t\t\t\t"+t._s(t.results.found_columns_count)+"\n\t\t\t")])]),t._v(" "),e("tr",[e("td",[t._v(t._s(t.t("tables","Matching columns")))]),t._v(" "),e("td",{attrs:{"data-cy":"importResultColumnsMatch"}},[t._v("\n\t\t\t\t"+t._s(t.results.matching_columns_count)+"\n\t\t\t")])]),t._v(" "),e("tr",[e("td",[t._v(t._s(t.t("tables","Created columns")))]),t._v(" "),e("td",{attrs:{"data-cy":"importResultColumnsCreated"}},[t._v("\n\t\t\t\t"+t._s(t.results.created_columns_count)+"\n\t\t\t")])]),t._v(" "),e("tr",[e("td",[t._v(t._s(t.t("tables","Inserted rows")))]),t._v(" "),e("td",{attrs:{"data-cy":"importResultRowsInserted"}},[t._v("\n\t\t\t\t"+t._s(t.results.inserted_rows_count)+"\n\t\t\t")])]),t._v(" "),e("tr",[e("td",[t._v(t._s(t.t("tables","Value parsing errors")))]),t._v(" "),e("td",{attrs:{"data-cy":"importResultParsingErrors"}},[t._v("\n\t\t\t\t"+t._s(t.results.errors_parsing_count)+"\n\t\t\t")])]),t._v(" "),e("tr",[e("td",[t._v(t._s(t.t("tables","Row creation errors")))]),t._v(" "),e("td",{attrs:{"data-cy":"importResultRowErrors"}},[t._v("\n\t\t\t\t"+t._s(t.results.errors_count)+"\n\t\t\t")])])])])}),[],!1,null,"1f266310",null).exports;async function N(t,e,s){return(await i.Ay.post((0,n.Jv)(`/apps/tables/import/table/${t}`),{path:e,createMissingColumns:s})).data}const F={name:"FileActionImport",components:{NcButton:a.x1,NcDialog:a.i$,ImportResults:D,NcLoadingIcon:a.ne,NcSelect:a.EQ,NcCheckboxRadioSwitch:a.AO,NcEmojiPicker:a.in,RowFormWrapper:T},props:{file:{type:l.bP,default:null}},data(){return{importAsNew:!0,createMissingColumns:!0,loadingTables:!1,importingFile:!1,newTable:{emoji:"ðŸ”§",title:this.file.basename},existingTables:[],selectedTable:null,importResults:null,showResultsDialog:!0}},computed:{tableOptions(){return this.existingTables.map((t=>({label:`${t.emoji} ${t.title}`,value:t.id})))??"No existing tables"}},async mounted(){this.loadingTables=!0;const t=await i.Ay.get((0,n.Jv)("/apps/tables/table"));t.data&&t.data.forEach((t=>this.existingTables.push({title:t.title,emoji:t.emoji,id:t.id}))),this.loadingTables=!1},methods:{t:r.Tl,selectIcon(t){this.newTable.emoji=t},setNewTableTitle(t){this.newTable.title=t.srcElement.value},closeResultsDialog(){this.showResultsDialog=!1},async importFile(){if(this.importingFile=!0,this.importAsNew)this.importResults=await async function(t,e,s){const a=await async function(t,e){const s=await i.Ay.post((0,n.Jv)("/apps/tables/table"),{title:t,emoji:e,template:"custom"});return s.data}(t,e);if(!a)return!1;return await N(a.id,s.path,!0)}(this.newTable.title,this.newTable.emoji,this.file),this.importResults||(0,o.Qg)((0,r.Tl)("tables","Could not create table"));else{if(!this.selectedTable)return void(0,o.Qg)((0,r.Tl)("tables","You must select an existing table"));this.importResults=await async function(t,e,s){return await N(t,e.path,s)}(this.selectedTable.value,this.file,this.createMissingColumns),this.importResults||(0,o.Qg)((0,r.Tl)("tables","Could not import data to table"))}this.importingFile=!1},closeImportDialog(){this.$emit("close")}}};var k=s(98531),B={};B.styleTagTransform=v(),B.setAttributes=b(),B.insert=_().bind(null,"head"),B.domAPI=m(),B.insertStyleElement=w();u()(k.A,B);k.A&&k.A.locals&&k.A.locals;const P=(0,x.A)(F,(function(){var t=this,e=t._self._c;return t.importResults?e("NcDialog",{attrs:{name:t.t("tables","Import successful"),open:t.showResultsDialog,size:"small"},on:{"update:open":function(e){t.showResultsDialog=e}},scopedSlots:t._u([{key:"actions",fn:function(){return[e("NcButton",{attrs:{"aria-label":t.t("tables","Close")},on:{click:function(e){return t.closeResultsDialog()}}},[t._v("\n\t\t\t"+t._s(t.t("tables","Close"))+"\n\t\t")])]},proxy:!0}])},[t._v(" "),e("ImportResults",{attrs:{results:t.importResults}})],1):e("NcDialog",{attrs:{name:t.t("tables","Import file into Tables"),size:"normal"},on:{closing:t.closeImportDialog}},[e("div",{staticClass:"modal__content"},[e("RowFormWrapper",{staticClass:"row",attrs:{title:t.t("tables","Import as new table"),description:t.t("tables","This will create a new table from the data in this file.")}},[e("div",{staticStyle:{display:"flex","flex-flow":"row wrap","align-items":"center"}},[e("NcCheckboxRadioSwitch",{staticClass:"switch",staticStyle:{"flex-grow":"0"},attrs:{"data-cy":"importAsNewTableSwitch","aria-label":t.t("tables","Import as new table"),checked:t.importAsNew,type:"switch"},on:{"update:checked":function(e){t.importAsNew=e}}},[t._v("\n\t\t\t\t\t"+t._s(t.t("tables","Import as new table"))+"\n\t\t\t\t")]),t._v(" "),e("div",{staticStyle:{display:"flex","flex-flow":"row nowrap","flex-grow":"1"}},[e("NcEmojiPicker",{attrs:{"close-on-select":!0},on:{select:t.selectIcon}},[e("NcButton",{attrs:{"aria-label":t.t("tables","Select emoji for table"),type:"tertiary",disabled:!t.importAsNew},on:{click:function(t){t.preventDefault()}},scopedSlots:t._u([{key:"icon",fn:function(){return[t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.newTable.emoji)+"\n\t\t\t\t\t\t\t")]},proxy:!0}],null,!1,2481979675)})],1),t._v(" "),e("input",{staticStyle:{"flex-grow":"1"},attrs:{"aria-label":t.t("tables","Title of the new table"),placeholder:t.newTable.title,disabled:!t.importAsNew},on:{input:t.setNewTableTitle}})],1)],1)]),t._v(" "),e("RowFormWrapper",{staticClass:"row",attrs:{title:t.t("tables","Import into existing table"),description:t.t("tables","This will import the data from this file into an already existing table.")}},[e("div",{staticStyle:{display:"flex","flex-flow":"row nowrap",margin:"20px 0"}},[e("NcSelect",{staticStyle:{"flex-grow":"1"},attrs:{"data-cy":"selectExistingTableDropdown",options:t.tableOptions,"aria-label-combobox":t.t("tables","Select the table to import into"),placeholder:t.t("tables","Select an existing table"),disabled:t.importAsNew,loading:t.loadingTables},model:{value:t.selectedTable,callback:function(e){t.selectedTable=e},expression:"selectedTable"}})],1)]),t._v(" "),e("NcCheckboxRadioSwitch",{staticStyle:{"flex-grow":"0"},attrs:{"aria-label":t.t("tables","Create missing columns"),type:"switch",disabled:t.importAsNew,checked:t.createMissingColumns},on:{"update:checked":function(e){t.createMissingColumns=e}}},[t._v("\n\t\t\t"+t._s(t.t("tables","Create missing columns"))+"\n\t\t")]),t._v(" "),e("div",{staticClass:"end"},[e("NcButton",{attrs:{"data-cy":"fileActionImportButton","aria-label":t.t("tables","Import"),type:"primary",disabled:t.importingFile},on:{click:t.importFile},scopedSlots:t._u([t.importingFile?{key:"icon",fn:function(){return[e("NcLoadingIcon",{attrs:{size:20}})]},proxy:!0}:null],null,!0)},[t._v("\n\n\t\t\t\t"+t._s(t.t("tables","Import"))+"\n\t\t\t")])],1)],1)])}),[],!1,null,"773d887d",null).exports},27518:t=>{t.exports="data:image/svg+xml,%3c%21--%20-%20SPDX-FileCopyrightText:%202020%20Google%20Inc.%20-%20SPDX-License-Identifier:%20Apache-2.0%20--%3e%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M15.4%2016.6L10.8%2012l4.6-4.6L14%206l-6%206%206%206%201.4-1.4z%27/%3e%3c/svg%3e"},27514:t=>{t.exports="data:image/svg+xml,%3c%21--%20-%20SPDX-FileCopyrightText:%202020%20Google%20Inc.%20-%20SPDX-License-Identifier:%20Apache-2.0%20--%3e%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M18.4%207.4L17%206l-6%206%206%206%201.4-1.4-4.6-4.6%204.6-4.6m-6%200L11%206l-6%206%206%206%201.4-1.4L7.8%2012l4.6-4.6z%27/%3e%3c/svg%3e"},79722:t=>{t.exports="data:image/svg+xml,%3c%21--%20-%20SPDX-FileCopyrightText:%202020%20Google%20Inc.%20-%20SPDX-License-Identifier:%20Apache-2.0%20--%3e%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M5.6%207.4L7%206l6%206-6%206-1.4-1.4%204.6-4.6-4.6-4.6m6%200L13%206l6%206-6%206-1.4-1.4%204.6-4.6-4.6-4.6z%27/%3e%3c/svg%3e"},86886:t=>{t.exports="data:image/svg+xml,%3c%21--%20-%20SPDX-FileCopyrightText:%202020%20Google%20Inc.%20-%20SPDX-License-Identifier:%20Apache-2.0%20--%3e%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M8.6%2016.6l4.6-4.6-4.6-4.6L10%206l6%206-6%206-1.4-1.4z%27/%3e%3c/svg%3e"}}]);
//# sourceMappingURL=tables-src_modules_modals_FileActionImport_vue-data_image_svg_xml_3c_21--_20-_20SPDX-FileCopyrightTe-e9dd95.js.map?v=d64f06c9b4ff704061e9