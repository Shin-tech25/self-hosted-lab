"use strict";(self.webpackChunktables=self.webpackChunktables||[]).push([["src_views_SmartPicker_vue"],{17829:(e,t,a)=>{a.d(t,{A:()=>l});var s=a(71354),n=a.n(s),i=a(76314),o=a.n(i)()(n());o.push([e.id,".picker-content[data-v-37c6cc23]{width:100%;min-height:350px;display:flex;flex-direction:column;overflow-y:auto;padding:0 16px 16px 16px}.picker-content>h2[data-v-37c6cc23]{margin:12px 0;text-align:center}h3[data-v-37c6cc23]{margin:0}.space-B[data-v-37c6cc23]{margin-bottom:calc(var(--default-grid-baseline)*4)}.space-T[data-v-37c6cc23]{margin-top:calc(var(--default-grid-baseline)*2)}table[data-v-37c6cc23]{width:100%}table th[data-v-37c6cc23],table td[data-v-37c6cc23]{border:none !important;width:50%;padding-left:calc(var(--default-grid-baseline)*2);padding-right:calc(var(--default-grid-baseline)*2)}.radio[data-v-37c6cc23]{display:flex}.radio>span[data-v-37c6cc23]{padding-right:calc(var(--default-grid-baseline)*6)}.radio label .material-design-icon[data-v-37c6cc23]{padding-right:calc(var(--default-grid-baseline)*1)}.select-button[data-v-37c6cc23]{bottom:0;width:100%;display:flex;align-items:end;flex-direction:column;position:sticky}.selection-wrapper[data-v-37c6cc23]{width:100%}.selection-wrapper .selection[data-v-37c6cc23]{margin-left:auto;margin-right:auto;width:550px}.preview[data-v-37c6cc23]{border:2px solid var(--color-border);border-radius:var(--border-radius-large)}","",{version:3,sources:["webpack://./src/views/SmartPicker.vue"],names:[],mappings:"AAEA,iCACC,UAAA,CACA,gBAAA,CACA,YAAA,CACA,qBAAA,CACA,eAAA,CACA,wBAAA,CAGD,oCACC,aAAA,CACA,iBAAA,CAGD,oBACC,QAAA,CAGD,0BACC,kDAAA,CAGD,0BACC,+CAAA,CAGD,uBACC,UAAA,CAGD,oDACC,sBAAA,CACA,SAAA,CACA,iDAAA,CACA,kDAAA,CAGD,wBACC,YAAA,CAGD,6BACC,kDAAA,CAGD,oDACC,kDAAA,CAGD,gCACC,QAAA,CACA,UAAA,CACA,YAAA,CACA,eAAA,CACA,qBAAA,CACA,eAAA,CAGD,oCACC,UAAA,CAGD,+CACC,gBAAA,CACA,iBAAA,CACA,WAAA,CAGD,0BACC,oCAAA,CACA,wCAAA",sourceRoot:""}]);const l=o},11002:(e,t,a)=>{a.d(t,{A:()=>l});var s=a(71354),n=a.n(s),i=a(76314),o=a.n(i)()(n());o.push([e.id,".icon-label-container[data-v-2285b36a]{display:flex;align-items:center}.icon-label-container img[data-v-2285b36a],.icon-label-container[data-v-2285b36a] svg{margin-right:calc(var(--default-grid-baseline)*2)}.labels[data-v-2285b36a]{display:block}.content[data-v-2285b36a]{display:block}.content .labels[data-v-2285b36a]{font-size:1.3em;font-weight:bold;margin-bottom:8px}.content .details[data-v-2285b36a]{display:inline-flex}[data-v-2285b36a] .counter-bubble__counter{max-width:fit-content !important;height:100%}","",{version:3,sources:["webpack://./src/views/partials/SearchAndSelectOption.vue"],names:[],mappings:"AAEA,uCACC,YAAA,CACA,kBAAA,CACA,sFACC,iDAAA,CAIF,yBACC,aAAA,CAGD,0BACC,aAAA,CAGD,kCACC,eAAA,CACA,gBAAA,CACA,iBAAA,CAGD,mCACC,mBAAA,CAGD,2CACC,gCAAA,CACA,WAAA",sourceRoot:""}]);const l=o},94064:(e,t,a)=>{a.d(t,{A:()=>l});var s=a(71354),n=a.n(s),i=a(76314),o=a.n(i)()(n());o.push([e.id,"[data-v-2c3a0d28] .v-select.select{width:100%}[data-v-2c3a0d28] #smartpicker-select input[type=search]{height:41px}[data-v-2c3a0d28] #smartpicker-select .details{display:inline-flex;align-items:self-start}[data-v-2c3a0d28] #smartpicker-select .vs__selected-options{padding-top:calc(var(--default-grid-baseline)*3);padding-bottom:calc(var(--default-grid-baseline)*3)}[data-v-2c3a0d28] #smartpicker-select .vs__selected{margin-left:0}","",{version:3,sources:["webpack://./src/views/sections/Search.vue"],names:[],mappings:"AAEA,mCACC,UAAA,CAGD,yDACC,WAAA,CAGD,+CACC,mBAAA,CACA,sBAAA,CAGD,4DACC,gDAAA,CACA,mDAAA,CAGD,oDACC,aAAA",sourceRoot:""}]);const l=o},31754:(e,t,a)=>{a.d(t,{default:()=>W});var s=a(53334),n=a(76333),i=a(9612),o=a(24319);const l={name:"PageNextOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var c=a(14486);const r=(0,c.A)(l,(function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon page-next-outline-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M22,3H5A2,2 0 0,0 3,5V9H5V5H22V19H5V15H3V19A2,2 0 0,0 5,21H22A2,2 0 0,0 24,19V5A2,2 0 0,0 22,3M7,15V13H0V11H7V9L11,12L7,15M20,13H13V11H20V13M20,9H13V7H20V9M17,17H13V15H17V17Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])}),[],!1,null,null,null).exports,d={components:{NcCounterBubble:n.E7,NcUserBubble:n.Z9,IconTable:i.A,IconView:o.A,IconRow:r},filters:{truncate:(e,t)=>e?e.length>=t?e.substring(0,t)+"...":e:""},props:{label:{type:String,default:""},type:{type:String,default:"table"},emoji:{type:String,default:null},owner:{type:String,default:null},ownerDisplayName:{type:String,default:null},rowsCount:{type:Number,default:null},subline:{type:String,default:null}},methods:{t:s.Tl,n:s.zw}};var A=a(85072),u=a.n(A),C=a(97825),p=a.n(C),v=a(77659),_=a.n(v),h=a(55056),b=a.n(h),m=a(10540),g=a.n(m),w=a(41113),f=a.n(w),y=a(11002),k={};k.styleTagTransform=f(),k.setAttributes=b(),k.insert=_().bind(null,"head"),k.domAPI=p(),k.insertStyleElement=g();u()(y.A,k);y.A&&y.A.locals&&y.A.locals;const x=(0,c.A)(d,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"icon-label-container"},["table"===e.type?t("IconTable",{attrs:{size:40}}):e._e(),e._v(" "),"view"===e.type?t("IconView",{attrs:{size:40}}):e._e(),e._v(" "),"row"===e.type?t("IconRow",{attrs:{size:40}}):e._e(),e._v(" "),t("div",{staticClass:"content"},[t("div",{staticClass:"labels"},[e._v("\n\t\t\t"+e._s(e.emoji?e.emoji+" ":"")+e._s(e.label)+"\n\t\t")]),e._v(" "),t("div",{staticClass:"details"},[e.owner?t("NcUserBubble",{attrs:{user:e.owner,"display-name":e.ownerDisplayName??e.owner}}):e._e(),e._v("Â \n\t\t\t"),null!==e.rowsCount?t("NcCounterBubble",[e._v("\n\t\t\t\t"+e._s(e.n("tables","{nb} row","{nb} rows",e.rowsCount,{nb:e.rowsCount}))+"\n\t\t\t")]):e._e(),e._v(" "),e.subline?t("div",{staticClass:"subline p span"},[e._v("\n\t\t\t\t"+e._s(e.subline)+"\n\t\t\t")]):e._e()],1)])],1)}),[],!1,null,"2285b36a",null).exports;var j=a(17334),S=a.n(j),D=a(70715),B=a(63814),N=a(88413);const O={components:{NcSelect:n.EQ,SearchAndSelectOption:x},props:{value:{type:Object,default:null}},data:()=>({loading:!1,term:null,options:[]}),computed:{getOptions(){return[...this.options].sort(((e,t)=>e.quality-t.quality))},localValue:{get(){return this.value},set(e){this.$emit("update:value",e)}}},watch:{term(){this.debounceSubmit()}},mounted(){},methods:{t:s.Tl,async loadResultsFromBE(){this.loading=!0;try{const e=await D.Ay.get((0,B.Jv)("/apps/tables/search/all?term="+this.term));console.debug("res",e),this.options=e.data}catch(e){(0,N.A)(e,(0,s.Tl)("tables","Could not load search results."))}this.loading=!1},async load(){this.term?.length>=3&&await this.loadResultsFromBE()},debounceSubmit:S()((function(){this.load()}),500)}};var I=a(94064),T={};T.styleTagTransform=f(),T.setAttributes=b(),T.insert=_().bind(null,"head"),T.domAPI=p(),T.insertStyleElement=g();u()(I.A,T);I.A&&I.A.locals&&I.A.locals;const L=(0,c.A)(O,(function(){var e=this,t=e._self._c;return t("div",[t("NcSelect",{attrs:{id:"smartpicker-select",loading:e.loading,placeholder:e.t("tables","Search for table and views..."),"aria-label-combobox":e.t("tables","Search for table and views..."),options:e.getOptions},on:{search:t=>e.term=t},scopedSlots:e._u([{key:"option",fn:function(e){return[t("SearchAndSelectOption",{attrs:{label:e.label,emoji:e.emoji,owner:e.owner,"owner-display-name":e.ownerDisplayName,"rows-count":e.rowsCount,type:e.type,subline:e.subline}})]}},{key:"selected-option",fn:function(e){return[t("SearchAndSelectOption",{attrs:{label:e.label,emoji:e.emoji,owner:e.owner,"owner-display-name":e.ownerDisplayName,"rows-count":e.rowsCount,subline:e.subline,type:e.type}})]}}]),model:{value:e.localValue,callback:function(t){e.localValue=t},expression:"localValue"}})],1)}),[],!1,null,"2c3a0d28",null).exports;var G=a(26546);const R={name:"CheckIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};const V=(0,c.A)(R,(function(){var e=this,t=e._self._c;return t("span",e._b({staticClass:"material-design-icon check-icon",attrs:{"aria-hidden":e.title?null:"true","aria-label":e.title,role:"img"},on:{click:function(t){return e.$emit("click",t)}}},"span",e.$attrs,!1),[t("svg",{staticClass:"material-design-icon__svg",attrs:{fill:e.fillColor,width:e.size,height:e.size,viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}},[e.title?t("title",[e._v(e._s(e.title))]):e._e()])])])}),[],!1,null,null,null).exports;var M=a(162),z=a(79779),E=a(88166);const H={components:{IconTables:i.A,IconLink:G.A,IconText:o.A,IconCheck:V,NcEmptyContent:n.yI,Search:L,NcCheckboxRadioSwitch:n.AO,NcButton:n.x1,LinkReferenceWidget:M.default,ContentReferenceWidget:z.default,NcLoadingIcon:n.ne},setup:()=>({tablesStore:(0,E.I)()}),data:()=>({renderMode:"link",value:null,previewLoading:!1,richObject:{}}),computed:{getLink(){if(!this.value)return"";const e="content"===this.renderMode?"/content":"";return window.location.protocol+"//"+window.location.host+(0,B.Jv)("/apps/tables/#/"+this.value?.type+"/"+this.value?.value+e)}},watch:{renderMode(){this.updateContent()},value(){this.updateRichObject(),this.updateContent()}},async mounted(){if(!this.tablesStore){const{default:e}=await Promise.all([a.e("vendors-node_modules_nextcloud_axios_dist_index_mjs"),a.e("vendors-node_modules_vue_dist_vue_runtime_esm_js"),a.e("vendors-node_modules_nextcloud_auth_dist_index_mjs-node_modules_nextcloud_vue_dist_Components-10e4a1"),a.e("vendors-node_modules_path-browserify_index_js-node_modules_toastify-js_src_toastify_js-node_m-e96381"),a.e("vendors-node_modules_nextcloud_dialogs_dist_index_mjs-node_modules_nextcloud_router_dist_inde-72797a"),a.e("src_store_data_js-src_store_store_js"),a.e("store")]).then(a.bind(a,88166)),{default:t}=await Promise.all([a.e("vendors-node_modules_nextcloud_axios_dist_index_mjs"),a.e("vendors-node_modules_vue_dist_vue_runtime_esm_js"),a.e("vendors-node_modules_nextcloud_auth_dist_index_mjs-node_modules_nextcloud_vue_dist_Components-10e4a1"),a.e("vendors-node_modules_path-browserify_index_js-node_modules_toastify-js_src_toastify_js-node_m-e96381"),a.e("vendors-node_modules_nextcloud_dialogs_dist_index_mjs-node_modules_nextcloud_router_dist_inde-72797a"),a.e("src_store_data_js-src_store_store_js"),a.e("store")]).then(a.bind(a,9795));this.tablesStore=e,this.tablesStore.data=t}},methods:{t:s.Tl,n:s.zw,async updateContent(){"content"===this.renderMode?(this.previewLoading=!0,await this.loadColumnsForContentPreview(),await this.loadRowsForContentPreview(),this.previewLoading=!1):(delete this.richObject.rows,delete this.richObject.columns)},selectReference(){this.$emit("submit",this.getLink)},updateRichObject(){this.richObject.emoji=this.value.emoji,this.richObject.link=this.getLink,this.richObject.ownerDisplayName=this.value.ownerDisplayName,this.richObject.ownership=this.value.owner,this.richObject.rowsCount=this.value.rowsCount,this.richObject.title=this.value.label,this.richObject.type=this.value.type,this.richObject.id=this.value.value},async loadColumnsForContentPreview(){if(null!==this.value)try{const e=await D.Ay.get((0,B.Jv)("/apps/tables/api/1/"+this.value.type+"s/"+this.value.value+"/columns"));console.debug("columns from BE",e.data),this.richObject.columns=e.data}catch(e){(0,N.A)(e,(0,s.Tl)("tables","Could not fetch columns for content preview."))}},async loadRowsForContentPreview(){if(null!==this.value)try{const e=await D.Ay.get((0,B.Jv)("/apps/tables/row/"+this.value.type+"/"+this.value.value));console.debug("rows from BE",e.data),this.richObject.rows=e.data}catch(e){(0,N.A)(e,(0,s.Tl)("tables","Could not fetch rows for content preview."))}}}},P=H;var F=a(17829),U={};U.styleTagTransform=f(),U.setAttributes=b(),U.insert=_().bind(null,"head"),U.domAPI=p(),U.insertStyleElement=g();u()(F.A,U);F.A&&F.A.locals&&F.A.locals;const W=(0,c.A)(P,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"picker-content"},[t("h2",{staticClass:"picker-title"},[e._v("\n\t\t"+e._s(e.t("tables","Nextcloud Tables"))+"\n\t")]),e._v(" "),t("div",{staticClass:"selection-wrapper"},[t("div",{staticClass:"selection"},[t("div",{staticClass:"space-T space-B"},[t("Search",{attrs:{value:e.value},on:{"update:value":function(t){e.value=t}}})],1),e._v(" "),t("div",{staticClass:"space-T space-B"},[t("h3",[e._v(e._s(e.t("tables","Render mode")))]),e._v(" "),t("div",{staticClass:"radio"},[t("NcCheckboxRadioSwitch",{attrs:{checked:e.renderMode,value:"link",name:"render-mode",type:"radio"},on:{"update:checked":function(t){e.renderMode=t}}},[t("IconLink",{attrs:{size:20}}),e._v(e._s(e.t("tables","Link"))+"\n\t\t\t\t\t")],1),e._v(" "),t("NcCheckboxRadioSwitch",{attrs:{checked:e.renderMode,value:"content",name:"render-mode",type:"radio"},on:{"update:checked":function(t){e.renderMode=t}}},[t("IconText",{attrs:{size:20}}),e._v(e._s(e.t("tables","Content"))+"\n\t\t\t\t\t")],1)],1)]),e._v(" "),e.getLink?t("div",{staticClass:"space-T space-B"},[t("h3",[e._v(e._s(e.t("tables","Preview")))]),e._v(" "),t("div",{staticClass:"preview space-T"},[e.previewLoading?t("div",[t("NcLoadingIcon")],1):t("div",["link"===e.renderMode?t("LinkReferenceWidget",{attrs:{"rich-object":e.richObject}}):e._e(),e._v(" "),"content"===e.renderMode?t("ContentReferenceWidget",{attrs:{"rich-object":e.richObject}}):e._e()],1)])]):t("NcEmptyContent",{scopedSlots:e._u([{key:"icon",fn:function(){return[t("IconTables")]},proxy:!0}])})],1)]),e._v(" "),t("div",{staticClass:"select-button"},[t("NcButton",{attrs:{type:"primary",disabled:null===e.value,"aria-label":e.t("tables","Select")},on:{click:e.selectReference},scopedSlots:e._u([{key:"icon",fn:function(){return[t("IconCheck",{attrs:{size:20}})]},proxy:!0}])},[e._v("\n\t\t\t"+e._s(e.t("tables","Insert"))+"\n\t\t")])],1)])}),[],!1,null,"37c6cc23",null).exports}}]);
//# sourceMappingURL=tables-src_views_SmartPicker_vue.js.map?v=176055edb5834c929976