{"version":3,"mappings":";;6EAKA,MAAeA,EAAA,CACb,KAAM,aAEN,OAAQ,SAASC,EAAG,CAClB,OAAOA,EAAE,MAAO,CACd,MAAO,sBACb,EAAO,CACDA,EAAE,MAAO,CACP,MAAO,cACP,IAAK,iBACb,CAAO,EACD,KAAK,QAAUA,EAAE,MAAO,CACtB,MAAO,mBACf,EAAS,CACDA,EAAE,OAAQ,CACR,MAAO,cACR,EACT,CAAO,EAAI,IACN,EACF,EAED,MAAO,CACL,OAAQ,CACN,KAAM,OACN,SAAU,EACX,EACD,KAAM,CACJ,KAAM,OACN,SAAU,EACX,EACD,YAAa,CACX,KAAM,OACN,SAAU,EACX,EACD,YAAa,CACX,KAAM,OACN,QAAS,IACV,EACD,SAAU,CACR,KAAM,OACN,QAAS,IACf,CACG,EAED,MAAO,CACL,MAAO,CACL,QAAS,GACT,KAAM,KACN,UAAW,IACjB,CACG,EAED,SAAU,CACR,KAAK,SAAQ,CACd,EAED,eAAgB,CACV,KAAK,WAAa,KAAK,UAAU,SACnC,KAAK,UAAU,QAAO,CAEzB,EAED,QAAS,CACP,MAAM,UAAW,CACf,GAAI,CAEF,MAAMC,EAAO,MAAMC,EAAA,WAAO,4BAAQ,EAAC,0CAGnC,KAAK,KAAOD,EAAK,QAAQ,KAAK,MAAM,EAGpC,KAAK,UAAY,KAAK,KAAK,SAAS,KAAK,MAAM,gBAAiB,CAC9D,MAAO,OACP,OAAQ,OACR,OAAQ,MACT,GAGD,MAAM,KAAK,UAAU,QAAO,EAG5B,KAAK,sBAAqB,EAE1B,KAAK,QAAU,GACf,KAAK,MAAM,gBAAiB,EAAI,CACjC,OAAQE,EAAO,CACd,QAAQ,MAAM,sBAAuBA,CAAK,EAC1C,KAAK,QAAU,GACf,KAAK,MAAM,gBAAiB,EAAI,CACxC,CACK,EAED,uBAAwB,CACtB,OAAO,iBAAiB,QAAU,GAAM,CACjC,KAAK,aAGL,EAAE,SAAW,EAAE,SAAW,IAC7B,KAAK,UAAU,KAAI,GAGhB,EAAE,SAAW,EAAE,SAAW,IAC7B,KAAK,UAAU,KAAI,EAEtB,EACP,CACA,CACA","names":["EpubViewer","h","ePub","__vitePreload","error"],"ignoreList":[],"sources":["../src/components/EpubViewer.js"],"sourcesContent":["/**\n * @copyright Copyright (c) 2024\n * @license AGPL-3.0\n */\n\nexport default {\n  name: 'EpubViewer',\n  \n  render: function(h) {\n    return h('div', { \n      class: 'epubviewer-container',\n    }, [\n      h('div', { \n        class: 'epub-viewer',\n        ref: 'viewerContainer' \n      }),\n      this.loading ? h('div', { \n        class: 'epubviewer-loader' \n      }, [\n        h('span', { \n          class: 'icon-loading' \n        })\n      ]) : null\n    ])\n  },\n  \n  props: {\n    source: {\n      type: String,\n      required: true\n    },\n    size: {\n      type: Number,\n      required: true\n    },\n    permissions: {\n      type: String,\n      required: true\n    },\n    fileVersion: {\n      type: Number,\n      default: null\n    },\n    basename: {\n      type: String,\n      default: null\n    }\n  },\n  \n  data() {\n    return {\n      loading: true,\n      book: null,\n      rendition: null\n    }\n  },\n  \n  mounted() {\n    this.loadEpub()\n  },\n  \n  beforeDestroy() {\n    if (this.rendition && this.rendition.destroy) {\n      this.rendition.destroy()\n    }\n  },\n  \n  methods: {\n    async loadEpub() {\n      try {\n        // Dynamically import epub.js when needed\n        const ePub = await import('epubjs')\n        \n        // Create new book\n        this.book = ePub.default(this.source)\n        \n        // Initialize the rendition\n        this.rendition = this.book.renderTo(this.$refs.viewerContainer, {\n          width: '100%',\n          height: '100%',\n          spread: 'auto'\n        })\n\n        // Load and display\n        await this.rendition.display()\n\n        // Add keyboard navigation\n        this.setupKeyboardControls()\n\n        this.loading = false\n        this.$emit('update:loaded', true)\n      } catch (error) {\n        console.error('Error loading EPUB:', error)\n        this.loading = false\n        this.$emit('update:loaded', true)\n      }\n    },\n    \n    setupKeyboardControls() {\n      window.addEventListener('keyup', (e) => {\n        if (!this.rendition) return\n\n        // Arrow Left: Previous page\n        if ((e.keyCode || e.which) === 37) {\n          this.rendition.prev()\n        }\n        // Arrow Right: Next page\n        if ((e.keyCode || e.which) === 39) {\n          this.rendition.next()\n        }\n      })\n    }\n  }\n} "],"file":"js/EpubViewer-o4MLLv4Z.chunk.mjs"}