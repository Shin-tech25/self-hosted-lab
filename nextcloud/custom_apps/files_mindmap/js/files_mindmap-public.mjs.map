{"version":3,"file":"files_mindmap-public.mjs","sources":["../src/logger.js","../src/public.js"],"sourcesContent":["import { getLoggerBuilder } from '@nextcloud/logger'\n\n\nconst logger = getLoggerBuilder()\n\t.setApp('Files_MindMap')\n\t.detectUser()\n\t.build()\n\nexport default logger","import FilesMindMap from './mindmap'\nimport logger from './logger'\n\nimport { getSharingToken, isPublicShare } from '@nextcloud/sharing/public'\n\nif (isPublicShare()) {\n\tOCA.FilesMindMap = FilesMindMap;\n\tFilesMindMap.init();\n\n    if (FilesMindMap.isMindmapPublic()) {\n        window.addEventListener('DOMContentLoaded', function() {\n            var sharingToken = getSharingToken();\n            var downloadUrl = OC.generateUrl('/s/{token}/download', {token: sharingToken});\n            var viewer = OCA.FilesMindMap;\n\n\n            const contentElmt = document.getElementById('files-public-content');\n            const footerElmt = document.querySelector('body > footer') || document.querySelector('#app-content > footer');\n            if (contentElmt) {\n                if (OCA.Viewer) {\n                    contentElmt.innerHTML = '';\n                    OCA.Viewer.setRootElement('#files-public-content')\n\t\t\t\t    OCA.Viewer.open({ path: '/' });\n\n                    footerElmt.style.display = 'none';\n\n                    // This is an ugly implementation, need to remove the top margin after viewer creates the iframe\n                    setTimeout(() => {\n                        const frameElmt = document.querySelector('#viewer > iframe');\n                        if (frameElmt) {\n                            frameElmt.style.marginTop = '0';\n                        }\n                    }, 1000);\n\n                } else {\n                    logger.error('Viewer is not available, cannot preview mindmap');\n                }\n            }\n\n        });\n    }\n    \n    \n    console.log('files_mindmap public.js loaded');\n}"],"names":["logger","getLoggerBuilder","isPublicShare","FilesMindMap","sharingToken","getSharingToken","contentElmt","footerElmt","frameElmt"],"mappings":";qEAGA,MAAMA,EAASC,EAAgB,EAC7B,OAAO,eAAe,EACtB,WAAU,EACV,MAAK,ECDHC,MACH,IAAI,aAAeC,EACnBA,EAAa,KAAM,EAEZA,EAAa,mBACb,OAAO,iBAAiB,mBAAoB,UAAW,CACnD,IAAIC,EAAeC,EAAiB,EAClB,GAAG,YAAY,sBAAuB,CAAC,MAAOD,CAAY,CAAC,EAChE,IAAI,aAGjB,MAAME,EAAc,SAAS,eAAe,sBAAsB,EAC5DC,EAAa,SAAS,cAAc,eAAe,GAAK,SAAS,cAAc,uBAAuB,EACxGD,IACI,IAAI,QACJA,EAAY,UAAY,GACxB,IAAI,OAAO,eAAe,uBAAuB,EAC7D,IAAI,OAAO,KAAK,CAAE,KAAM,GAAG,CAAE,EAEjBC,EAAW,MAAM,QAAU,OAG3B,WAAW,IAAM,CACb,MAAMC,EAAY,SAAS,cAAc,kBAAkB,EACvDA,IACAA,EAAU,MAAM,UAAY,IAEnC,EAAE,GAAI,GAGPR,EAAO,MAAM,iDAAiD,EAIlF,CAAS,EAIL,QAAQ,IAAI,gCAAgC"}