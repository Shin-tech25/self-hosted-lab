!function(e){e.Onlyoffice=_.extend({AppName:"onlyoffice",frameSelector:null,titleBase:window.document.title,favIconBase:$('link[rel="icon"]').attr("href")},e.Onlyoffice),e.Onlyoffice.onRequestClose=function(){$(e.Onlyoffice.frameSelector).remove(),e.Viewer&&e.Viewer.close&&e.Viewer.close(),e.Onlyoffice.CloseEditor&&e.Onlyoffice.CloseEditor()},e.Onlyoffice.onRequestSaveAs=function(o){OC.dialogs.filepicker(t(e.Onlyoffice.AppName,"Save as"),(function(n){o.dir=n,$(e.Onlyoffice.frameSelector)[0].contentWindow.OCA.Onlyoffice.editorSaveAs(o)}),!1,"httpd/unix-directory",!0,OC.dialogs.FILEPICKER_TYPE_CHOOSE,o.dir)},e.Onlyoffice.onRequestInsertImage=function(o){OC.dialogs.filepicker(t(e.Onlyoffice.AppName,"Insert image"),$(e.Onlyoffice.frameSelector)[0].contentWindow.OCA.Onlyoffice.editorInsertImage,!1,o,!0)},e.Onlyoffice.onRequestMailMergeRecipients=function(o){OC.dialogs.filepicker(t(e.Onlyoffice.AppName,"Select recipients"),$(e.Onlyoffice.frameSelector)[0].contentWindow.OCA.Onlyoffice.editorSetRecipient,!1,o,!0)},e.Onlyoffice.onRequestSelectDocument=function(o,n){let i;switch(n){case"combine":i=t(e.Onlyoffice.AppName,"Select file to combine");break;case"compare":i=t(e.Onlyoffice.AppName,"Select file to compare");break;case"insert-text":i=t(e.Onlyoffice.AppName,"Select file to insert text");break;default:i=t(e.Onlyoffice.AppName,"Select file")}OC.dialogs.filepicker(i,$(e.Onlyoffice.frameSelector)[0].contentWindow.OCA.Onlyoffice.editorSetRequested.bind({documentSelectionType:n}),!1,o,!0)},e.Onlyoffice.onRequestReferenceSource=function(o){OC.dialogs.filepicker(t(e.Onlyoffice.AppName,"Select data source"),$(e.Onlyoffice.frameSelector)[0].contentWindow.OCA.Onlyoffice.editorReferenceSource,!1,o,!0)},e.Onlyoffice.onDocumentReady=function(){e.Onlyoffice.setViewport()},e.Onlyoffice.changeFavicon=function(e){$('link[rel="icon"]').attr("href",e)},e.Onlyoffice.setViewport=function(){document.querySelector('meta[name="viewport"]').setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0")},e.Onlyoffice.onShowMessage=function(e){switch(e.type){case"success":OCP.Toast.success(e.message,e.props);break;case"error":OCP.Toast.error(e.message,e.props)}},window.addEventListener("message",(function(o){if($(e.Onlyoffice.frameSelector).length&&$(e.Onlyoffice.frameSelector)[0].contentWindow===o.source&&o.data.method)switch(o.data.method){case"editorRequestClose":e.Onlyoffice.onRequestClose();break;case"editorRequestSharingSettings":e.Onlyoffice.OpenShareDialog&&e.Onlyoffice.OpenShareDialog();break;case"onRefreshVersionsDialog":e.Onlyoffice.RefreshVersionsDialog&&e.Onlyoffice.RefreshVersionsDialog();break;case"editorRequestSaveAs":e.Onlyoffice.onRequestSaveAs(o.data.param);break;case"editorRequestInsertImage":e.Onlyoffice.onRequestInsertImage(o.data.param);break;case"editorRequestMailMergeRecipients":e.Onlyoffice.onRequestMailMergeRecipients(o.data.param);break;case"editorRequestSelectDocument":e.Onlyoffice.onRequestSelectDocument(o.data.param,o.data.documentSelectionType);break;case"editorRequestReferenceSource":e.Onlyoffice.onRequestReferenceSource(o.data.param);break;case"onDocumentReady":e.Onlyoffice.onDocumentReady(o.data.param);break;case"changeFavicon":e.Onlyoffice.changeFavicon(o.data.param);break;case"onShowMessage":e.Onlyoffice.onShowMessage(o.data.param)}}),!1),window.addEventListener("popstate",(function(o){$(e.Onlyoffice.frameSelector).length&&e.Onlyoffice.onRequestClose()})),new MutationObserver((o=>{o[0]&&o[0].removedNodes&&o[0].removedNodes.forEach((o=>{o.id&&"#"+o.id===e.Onlyoffice.frameSelector&&(e.Onlyoffice.changeFavicon(e.Onlyoffice.favIconBase),window.document.title=e.Onlyoffice.titleBase,e.Onlyoffice.frameSelector=null)}))})).observe(document.querySelector("body"),{childList:!0,subtree:!0,characterDataOldValue:!0})}(OCA);
//# sourceMappingURL=onlyoffice-listener.js.map?v=081a3500870308b71b20