{"version":3,"file":"onlyoffice-share.js?v=20aba8f02dd218945eb4","mappings":"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","sources":["webpack:///onlyoffice/src/share.js","webpack:///onlyoffice/img/app-dark.svg"],"sourcesContent":["/**\n *\n * (c) Copyright Ascensio System SIA 2025\n *\n * This program is a free software product.\n * You can redistribute it and/or modify it under the terms of the GNU Affero General Public License\n * (AGPL) version 3 as published by the Free Software Foundation.\n * In accordance with Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect\n * that Ascensio System SIA expressly excludes the warranty of non-infringement of any third-party rights.\n *\n * This program is distributed WITHOUT ANY WARRANTY;\n * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n * For details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\n *\n * You can contact Ascensio System SIA at 20A-12 Ernesta Birznieka-Upisha street, Riga, Latvia, EU, LV-1050.\n *\n * The interactive user interfaces in modified source and object code versions of the Program\n * must display Appropriate Legal Notices, as required under Section 5 of the GNU AGPL version 3.\n *\n * Pursuant to Section 7(b) of the License you must retain the original Product logo when distributing the program.\n * Pursuant to Section 7(e) we decline to grant you any rights under trademark law for use of our trademarks.\n *\n * All the Product's GUI elements, including illustrations and icon sets, as well as technical\n * writing content are licensed under the terms of the Creative Commons Attribution-ShareAlike 4.0 International.\n * See the License terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\n *\n */\n\n/* eslint-disable import/no-webpack-loader-syntax */\n/* eslint-disable import/no-unresolved */\n\n/* global _, jQuery */\n\nimport AppDarkSvg from '!!raw-loader!../img/app-dark.svg';\n\n/**\n * @param {object} $ JQueryStatic object\n * @param {object} OC Nextcloud OCA object\n */\n(function($, OC) {\n\n\tOCA.Onlyoffice = _.extend({\n\t\tAppName: 'onlyoffice',\n\t}, OCA.Onlyoffice)\n\n\tOCA.Onlyoffice.Permissions = {\n\t\tNone: 0,\n\t\tReview: 1,\n\t\tComment: 2,\n\t\tFillForms: 4,\n\t\tModifyFilter: 8,\n\t}\n\n\tlet tabcontext = null\n\n\tconst advancedTab = new OCA.Files.Sidebar.Tab({\n\t\tid: 'onlyofficeSharingTabView',\n\t\tname: t(OCA.Onlyoffice.AppName, 'Advanced'),\n\t\ticonSvg: AppDarkSvg,\n\n\t\tmount(el, fileInfo, context) {\n\t\t\tif (!tabcontext) {\n\t\t\t\ttabcontext = advancedContext()\n\t\t\t}\n\n\t\t\ttabcontext.init(el, fileInfo)\n\t\t},\n\n\t\tupdate(fileInfo) {\n\t\t\ttabcontext.update(fileInfo)\n\t\t},\n\n\t\tdestroy() {\n\t\t\ttabcontext.clear()\n\t\t},\n\n\t\tenabled(fileInfo) {\n\t\t\tlet canDisplay = false\n\n\t\t\tif (!fileInfo.isDirectory()) {\n\t\t\t\tconst ext = OCA.Onlyoffice.getFileExtension(fileInfo.name)\n\t\t\t\tconst format = OCA.Onlyoffice.setting.formats[ext]\n\t\t\t\tif (format && (format.review\n\t\t\t\t\t|| format.comment\n\t\t\t\t\t|| format.fillForms\n\t\t\t\t\t|| format.modifyFilter)) {\n\t\t\t\t\tcanDisplay = true\n\n\t\t\t\t\tif (($('#sharing').hasClass('active') || $('#tab-button-sharing').hasClass('active'))\n\t\t\t\t\t\t&& tabcontext.fileInfo\n\t\t\t\t\t\t&& tabcontext.fileInfo.id === fileInfo.id) {\n\t\t\t\t\t\tthis.update(fileInfo)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn canDisplay\n\t\t},\n\t})\n\n\tconst advancedContext = function() {\n\t\tlet $el = null\n\n\t\tlet format = null\n\t\tlet fileInfo = null\n\t\tlet collection = null\n\t\tlet customEvents = null\n\t\tlet permissionsMenu = null\n\t\tlet templateItem = null\n\n\t\tconst getContainer = function() {\n\t\t\treturn $el.find('.onlyoffice-share-container')\n\t\t}\n\n\t\tconst getTemplate = function(callback) {\n\t\t\tif ($el.find('.onlyoffice-share-container').length === 0) {\n\t\t\t\t$('<ul>', { class: 'onlyoffice-share-container' }).appendTo($el)\n\t\t\t\t$('<div>').html(t(OCA.Onlyoffice.AppName, 'Provide advanced document permissions using ONLYOFFICE Docs')).prependTo($el)\n\t\t\t}\n\n\t\t\tif (templateItem) {\n\t\t\t\tcallback()\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t$.get(OC.filePath(OCA.Onlyoffice.AppName, 'templates', 'share.html'),\n\t\t\t\tfunction(tmpl) {\n\t\t\t\t\ttemplateItem = $(tmpl)\n\n\t\t\t\t\tcallback()\n\t\t\t\t})\n\t\t}\n\n\t\tconst render = function() {\n\t\t\tgetTemplate(() => {\n\t\t\t\tcollection.forEach(extra => {\n\t\t\t\t\tconst itemNode = templateItem.clone()\n\t\t\t\t\tconst descNode = itemNode.find('span')\n\t\t\t\t\tconst avatar = itemNode.find('img')\n\t\t\t\t\tconst actionButton = itemNode.find('#onlyoffice-share-action')\n\n\t\t\t\t\tlet avatarSrc = '/index.php/avatar/' + extra.shareWith + '/32?v=0'\n\t\t\t\t\tlet label = extra.shareWithName\n\t\t\t\t\tif (extra.type === OC.Share.SHARE_TYPE_GROUP\n\t\t\t\t\t\t|| extra.type === OC.Share.SHARE_TYPE_ROOM) {\n\t\t\t\t\t\tavatarSrc = '/index.php/avatar/guest/' + extra.shareWith + '/32?v=0'\n\t\t\t\t\t\tlabel = extra.shareWith + ' (' + t(OCA.Onlyoffice.AppName, 'group') + ')'\n\t\t\t\t\t}\n\n\t\t\t\t\tif (extra.type === OC.Share.SHARE_TYPE_ROOM) {\n\t\t\t\t\t\tlabel = extra.shareWith + ' (' + t(OCA.Onlyoffice.AppName, 'conversation') + ')'\n\t\t\t\t\t}\n\n\t\t\t\t\tif (extra.type === OC.Share.SHARE_TYPE_LINK) {\n\t\t\t\t\t\tlabel = t(OCA.Onlyoffice.AppName, 'Share link')\n\n\t\t\t\t\t\tconst avatarWrapper = itemNode.find('.avatardiv')\n\t\t\t\t\t\tavatarWrapper.addClass('onlyoffice-share-link-avatar')\n\n\t\t\t\t\t\tavatarSrc = '/core/img/actions/public.svg'\n\t\t\t\t\t}\n\n\t\t\t\t\tactionButton.click(onClickPermissionMenu)\n\n\t\t\t\t\tavatar[0].src = avatarSrc\n\t\t\t\t\tdescNode[0].innerText = label\n\n\t\t\t\t\titemNode[0].id = extra.share_id\n\n\t\t\t\t\tgetContainer().append(itemNode)\n\t\t\t\t})\n\t\t\t})\n\t\t}\n\n\t\tconst onClickSetPermissions = function(e) {\n\t\t\tconst permissionValues = permissionsMenu.getValues()\n\t\t\tconst shareId = permissionsMenu.getTargetId()\n\t\t\tconst fileId = fileInfo.id\n\t\t\tconst extra = collection.find(item => item.share_id === shareId)\n\n\t\t\tlet permissions = OCA.Onlyoffice.Permissions.None\n\t\t\tif (permissionValues[OCA.Onlyoffice.Permissions.Review]) {\n\t\t\t\tpermissions |= OCA.Onlyoffice.Permissions.Review\n\t\t\t}\n\t\t\tif (permissionValues[OCA.Onlyoffice.Permissions.Comment]\n\t\t\t\t&& (permissions & OCA.Onlyoffice.Permissions.Review) !== OCA.Onlyoffice.Permissions.Review\n\t\t\t\t&& (permissions & OCA.Onlyoffice.Permissions.ModifyFilter) !== OCA.Onlyoffice.Permissions.ModifyFilter) {\n\t\t\t\tpermissions |= OCA.Onlyoffice.Permissions.Comment\n\t\t\t}\n\t\t\tif (permissionValues[OCA.Onlyoffice.Permissions.FillForms]\n\t\t\t\t&& (permissions & OCA.Onlyoffice.Permissions.Review) !== OCA.Onlyoffice.Permissions.Review) {\n\t\t\t\tpermissions |= OCA.Onlyoffice.Permissions.FillForms\n\t\t\t}\n\t\t\tif (permissionValues[OCA.Onlyoffice.Permissions.ModifyFilter]\n\t\t\t\t&& (permissions & OCA.Onlyoffice.Permissions.Comment) !== OCA.Onlyoffice.Permissions.Comment) {\n\t\t\t\tpermissions |= OCA.Onlyoffice.Permissions.ModifyFilter\n\t\t\t}\n\n\t\t\tpermissionsMenu.block(true)\n\t\t\tOCA.Onlyoffice.SetShares(extra.id, shareId, fileId, permissions, (extra) => {\n\t\t\t\tcollection.forEach(item => {\n\t\t\t\t\tif (item.share_id === extra.share_id) {\n\t\t\t\t\t\titem.id = extra.id\n\t\t\t\t\t\titem.permissions = extra.permissions\n\t\t\t\t\t\titem.available = extra.available\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\tconst attributes = getPermissionAttributes(extra)\n\n\t\t\t\tpermissionsMenu.refresh(attributes)\n\t\t\t\tpermissionsMenu.block(false)\n\t\t\t})\n\t\t}\n\n\t\tconst listenOuterClicks = function(event) {\n\t\t\tif (event.target.id === 'onlyoffice-share-action') {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tconst target = document.querySelector('#onlyoffice-share-popup-menu')\n\t\t\tif (target) {\n\t\t\t\tconst eventPath = event.composedPath().includes(target)\n\t\t\t\tif (!eventPath && typeof (permissionsMenu) !== 'undefined' && permissionsMenu.isOpen()) {\n\t\t\t\t\tpermissionsMenu.close()\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst onClickPermissionMenu = function(e) {\n\t\t\tif (!permissionsMenu) {\n\t\t\t\tpermissionsMenu = getPermissionMenu()\n\t\t\t}\n\t\t\twindow.addEventListener('click', listenOuterClicks)\n\n\t\t\tconst shareNode = $(e.target).closest('.onlyoffice-share-item')[0]\n\t\t\tconst shareId = shareNode.id\n\n\t\t\tif (permissionsMenu.isOpen()) {\n\t\t\t\tconst previousId = permissionsMenu.getTargetId()\n\t\t\t\tpermissionsMenu.close()\n\n\t\t\t\tif (previousId === shareId) return\n\t\t\t}\n\n\t\t\tconst extra = collection.find(item => item.share_id === shareId)\n\n\t\t\tconst attributes = getPermissionAttributes(extra)\n\n\t\t\tpermissionsMenu.open(extra.share_id, attributes, $(e.target).position())\n\t\t}\n\n\t\tconst getCustomEvents = function() {\n\t\t\tlet init = false\n\n\t\t\treturn {\n\t\t\t\ton() {\n\t\t\t\t\tif (!init) {\n\t\t\t\t\t\t$('#content').on('click', function(e) {\n\t\t\t\t\t\t\tconst target = $(e.target)[0]\n\t\t\t\t\t\t\tif (!permissionsMenu\n\t\t\t\t\t\t\t\t|| !permissionsMenu.isOpen()\n\t\t\t\t\t\t\t\t|| target.id === 'onlyoffice-share-action'\n\t\t\t\t\t\t\t\t|| target.className === 'onlyoffice-share-label'\n\t\t\t\t\t\t\t\t|| target.closest('.onlyoffice-share-action')) {\n\t\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tpermissionsMenu.close()\n\t\t\t\t\t\t})\n\n\t\t\t\t\t\tinit = true\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t}\n\t\t}\n\n\t\tconst getPermissionAttributes = function(extra) {\n\t\t\tconst attributes = []\n\n\t\t\tif (format.review\n\t\t\t\t&& (OCA.Onlyoffice.Permissions.Review & extra.available) === OCA.Onlyoffice.Permissions.Review) {\n\t\t\t\tconst review = (OCA.Onlyoffice.Permissions.Review & extra.permissions) === OCA.Onlyoffice.Permissions.Review\n\t\t\t\tattributes.push({\n\t\t\t\t\tchecked: review,\n\t\t\t\t\textra: OCA.Onlyoffice.Permissions.Review,\n\t\t\t\t\tlabel: t(OCA.Onlyoffice.AppName, 'Review only'),\n\t\t\t\t})\n\t\t\t}\n\t\t\tif (format.comment\n\t\t\t\t&& (OCA.Onlyoffice.Permissions.Comment & extra.available) === OCA.Onlyoffice.Permissions.Comment) {\n\t\t\t\tconst comment = (OCA.Onlyoffice.Permissions.Comment & extra.permissions) === OCA.Onlyoffice.Permissions.Comment\n\t\t\t\tattributes.push({\n\t\t\t\t\tchecked: comment,\n\t\t\t\t\textra: OCA.Onlyoffice.Permissions.Comment,\n\t\t\t\t\tlabel: t(OCA.Onlyoffice.AppName, 'Comment only'),\n\t\t\t\t})\n\t\t\t}\n\t\t\tif (format.fillForms\n\t\t\t\t&& (OCA.Onlyoffice.Permissions.FillForms & extra.available) === OCA.Onlyoffice.Permissions.FillForms) {\n\t\t\t\tconst fillForms = (OCA.Onlyoffice.Permissions.FillForms & extra.permissions) === OCA.Onlyoffice.Permissions.FillForms\n\t\t\t\tattributes.push({\n\t\t\t\t\tchecked: fillForms,\n\t\t\t\t\textra: OCA.Onlyoffice.Permissions.FillForms,\n\t\t\t\t\tlabel: t(OCA.Onlyoffice.AppName, 'Form filling'),\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tif (format.modifyFilter\n\t\t\t\t&& (OCA.Onlyoffice.Permissions.ModifyFilter & extra.available) === OCA.Onlyoffice.Permissions.ModifyFilter) {\n\t\t\t\tconst modifyFilter = (OCA.Onlyoffice.Permissions.ModifyFilter & extra.permissions) === OCA.Onlyoffice.Permissions.ModifyFilter\n\t\t\t\tattributes.push({\n\t\t\t\t\tchecked: modifyFilter,\n\t\t\t\t\textra: OCA.Onlyoffice.Permissions.ModifyFilter,\n\t\t\t\t\tlabel: t(OCA.Onlyoffice.AppName, 'Global filter'),\n\t\t\t\t})\n\t\t\t}\n\n\t\t\treturn attributes\n\t\t}\n\n\t\tconst getPermissionMenu = function() {\n\t\t\tconst popup = $('<div>', {\n\t\t\t\tclass: 'popovermenu onlyoffice-share-popup',\n\t\t\t\tid: 'onlyoffice-share-popup-menu',\n\t\t\t}).append($('<ul>'), {\n\t\t\t\tid: -1,\n\t\t\t})\n\n\t\t\tconst appendItem = function(checked, extra, name) {\n\t\t\t\tconst item = $('<li>').append($('<span>', {\n\t\t\t\t\tclass: 'onlyoffice-share-action',\n\t\t\t\t}).append($('<input>', {\n\t\t\t\t\tid: 'extra-' + extra,\n\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\tclass: 'checkbox action-checkbox__checkbox focusable',\n\t\t\t\t\tchecked,\n\t\t\t\t})).append($('<label>', {\n\t\t\t\t\tfor: 'extra-' + extra,\n\t\t\t\t\ttext: name,\n\t\t\t\t\tclass: 'onlyoffice-share-label',\n\t\t\t\t})))\n\n\t\t\t\tconst input = item.find('input')\n\t\t\t\tinput.click(onClickSetPermissions)\n\n\t\t\t\tpopup.find('ul').append(item)\n\t\t\t}\n\n\t\t\tconst removeItems = function() {\n\t\t\t\tconst items = popup.find('li')\n\t\t\t\tif (items) {\n\t\t\t\t\titems.remove()\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst setTargetId = function(id) {\n\t\t\t\tpopup.find('ul').attr('id', id)\n\t\t\t}\n\n\t\t\t$el.append(popup)\n\n\t\t\treturn {\n\t\t\t\tisOpen() {\n\t\t\t\t\treturn popup.is(':visible')\n\t\t\t\t},\n\n\t\t\t\topen(id, attributes, position) {\n\t\t\t\t\tremoveItems()\n\n\t\t\t\t\tif (position) {\n\t\t\t\t\t\tpopup.css({ top: position.top })\n\t\t\t\t\t}\n\n\t\t\t\t\tattributes.forEach(attr => {\n\t\t\t\t\t\tappendItem(attr.checked, attr.extra, attr.label)\n\t\t\t\t\t})\n\n\t\t\t\t\tsetTargetId(id)\n\t\t\t\t\tpopup.show()\n\t\t\t\t},\n\n\t\t\t\tclose() {\n\t\t\t\t\tremoveItems()\n\n\t\t\t\t\tsetTargetId(-1)\n\t\t\t\t\tpopup.hide()\n\t\t\t\t\twindow.removeEventListener('click', listenOuterClicks)\n\t\t\t\t},\n\n\t\t\t\trefresh(attributes) {\n\t\t\t\t\tremoveItems()\n\n\t\t\t\t\tattributes.forEach(attr => {\n\t\t\t\t\t\tappendItem(attr.checked, attr.extra, attr.label)\n\t\t\t\t\t})\n\t\t\t\t},\n\n\t\t\t\tblock(value) {\n\t\t\t\t\tpopup.find('input').prop('disabled', value)\n\t\t\t\t},\n\n\t\t\t\tgetValues() {\n\t\t\t\t\tconst values = []\n\n\t\t\t\t\tconst items = popup.find('input')\n\t\t\t\t\tfor (let i = 0; i < items.length; i++) {\n\t\t\t\t\t\tconst extra = items[i].id.split('extra-')[1]\n\t\t\t\t\t\tvalues[extra] = items[i].checked\n\t\t\t\t\t}\n\n\t\t\t\t\treturn values\n\t\t\t\t},\n\n\t\t\t\tgetTargetId() {\n\t\t\t\t\treturn popup.find('ul').attr('id')\n\t\t\t\t},\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tget fileInfo() {\n\t\t\t\treturn fileInfo\n\t\t\t},\n\n\t\t\tinit(_el, _fileInfo) {\n\t\t\t\t$el = $(_el)\n\n\t\t\t\tgetTemplate(() => {\n\t\t\t\t\tthis.update(_fileInfo)\n\t\t\t\t})\n\t\t\t},\n\n\t\t\tupdate(_fileInfo) {\n\t\t\t\tif (customEvents === null) {\n\t\t\t\t\tcustomEvents = getCustomEvents()\n\t\t\t\t\tcustomEvents.on()\n\t\t\t\t}\n\n\t\t\t\tgetContainer().children().remove()\n\n\t\t\t\tfileInfo = _fileInfo\n\n\t\t\t\tconst ext = OCA.Onlyoffice.getFileExtension(fileInfo.name)\n\t\t\t\tformat = OCA.Onlyoffice.setting.formats[ext]\n\n\t\t\t\tOCA.Onlyoffice.GetShares(fileInfo.id, (shares) => {\n\t\t\t\t\tcollection = shares\n\n\t\t\t\t\trender()\n\t\t\t\t})\n\t\t\t},\n\n\t\t\tclear() {\n\t\t\t\t$el = null\n\t\t\t\tformat = null\n\t\t\t\tfileInfo = null\n\t\t\t\tcollection = null\n\t\t\t\tpermissionsMenu = null\n\t\t\t},\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.GetShares = function(fileId, callback) {\n\t\t$.ajax({\n\t\t\turl: OC.linkToOCS('apps/' + OCA.Onlyoffice.AppName + '/api/v1/shares', 2) + fileId + '?format=json',\n\t\t\tsuccess: function onSuccess(response) {\n\t\t\t\tcallback(response.ocs.data)\n\t\t\t},\n\t\t})\n\t}\n\n\tOCA.Onlyoffice.SetShares = function(id, shareId, fileId, permissions, callback) {\n\t\tconst data = {\n\t\t\textraId: id,\n\t\t\tshareId,\n\t\t\tfileId,\n\t\t\tpermissions,\n\t\t}\n\n\t\t$.ajax({\n\t\t\tmethod: 'PUT',\n\t\t\turl: OC.linkToOCS('apps/' + OCA.Onlyoffice.AppName + '/api/v1', 2) + 'shares?format=json',\n\t\t\tdata,\n\t\t\tsuccess: function onSuccess(response) {\n\t\t\t\tcallback(response.ocs.data)\n\t\t\t},\n\t\t})\n\t}\n\n\tif (OCA.Files.Sidebar && OCA.Files.Sidebar.registerTab) {\n\t\tOCA.Files.Sidebar.registerTab(advancedTab)\n\t}\n\n})(jQuery, OC)\n","export default \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?>\\n<!-- Generator: Adobe Illustrator 19.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->\\n<svg version=\\\"1.1\\\" id=\\\"Layer_1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" x=\\\"0px\\\" y=\\\"0px\\\"\\n\\t viewBox=\\\"0 0 16 16\\\" style=\\\"enable-background:new 0 0 16 16;\\\" xml:space=\\\"preserve\\\">\\n<style type=\\\"text/css\\\">\\n\\t.st0{opacity:0.42;enable-background:new    ;}\\n\\t.st1{opacity:0.72;enable-background:new    ;}\\n</style>\\n<g id=\\\"XMLID_5_\\\">\\n\\t<path id=\\\"XMLID_3_\\\" class=\\\"st0\\\" d=\\\"M6.9,15.2l-6.4-3.1c-0.6-0.2-0.6-0.7,0-0.9l2.2-1.1l4.2,2c0.6,0.2,1.4,0.2,2,0l4.2-2l2.2,1.1\\n\\t\\tc0.6,0.2,0.6,0.7,0,0.9L9,15.2C8.4,15.4,7.5,15.4,6.9,15.2L6.9,15.2z\\\"/>\\n\\t<path id=\\\"XMLID_2_\\\" class=\\\"st1\\\" d=\\\"M6.9,11.5L0.5,8.5c-0.6-0.2-0.6-0.7,0-0.9l2.2-1.1l4.2,2c0.6,0.2,1.4,0.2,2,0l4.3-2l2.2,1\\n\\t\\tc0.6,0.2,0.6,0.7,0,0.9L9,11.4C8.4,11.8,7.5,11.8,6.9,11.5L6.9,11.5z\\\"/>\\n\\t<path id=\\\"XMLID_1_\\\" d=\\\"M6.9,7.9L0.5,4.8c-0.6-0.2-0.6-0.7,0-0.9l6.4-3.1c0.6-0.2,1.4-0.2,2,0l6.4,3.1c0.6,0.2,0.6,0.7,0,0.9\\n\\t\\tL8.9,7.9C8.4,8.1,7.5,8.1,6.9,7.9L6.9,7.9z\\\"/>\\n</g>\\n</svg>\\n\";"],"names":["$","OC","OCA","Onlyoffice","_","extend","AppName","Permissions","None","Review","Comment","FillForms","ModifyFilter","tabcontext","advancedTab","Files","Sidebar","Tab","id","name","t","iconSvg","mount","el","fileInfo","context","advancedContext","init","update","destroy","clear","enabled","canDisplay","isDirectory","ext","getFileExtension","format","setting","formats","review","comment","fillForms","modifyFilter","hasClass","this","$el","collection","customEvents","permissionsMenu","templateItem","getContainer","find","getTemplate","callback","length","class","appendTo","html","prependTo","get","filePath","tmpl","onClickSetPermissions","e","permissionValues","getValues","shareId","getTargetId","fileId","extra","item","share_id","permissions","block","SetShares","forEach","available","attributes","getPermissionAttributes","refresh","listenOuterClicks","event","target","document","querySelector","composedPath","includes","isOpen","close","onClickPermissionMenu","getPermissionMenu","window","addEventListener","closest","previousId","open","position","push","checked","label","popup","append","appendItem","type","for","text","click","removeItems","items","remove","setTargetId","attr","is","css","top","show","hide","removeEventListener","value","prop","values","i","split","_el","_fileInfo","on","className","getCustomEvents","children","GetShares","shares","itemNode","clone","descNode","avatar","actionButton","avatarSrc","shareWith","shareWithName","Share","SHARE_TYPE_GROUP","SHARE_TYPE_ROOM","SHARE_TYPE_LINK","addClass","src","innerText","ajax","url","linkToOCS","success","response","ocs","data","extraId","method","registerTab","jQuery"],"sourceRoot":""}